package Encoder;

import ch.ntb.inf.deep.runtime.mpc555.driver.TPU_FQD;
import ch.ntb.inf.deep.runtime.ppc32.Task;
import definitions.RobotConstants;

public class Encoder  extends Task{
	private TPU_FQD encoder = null;
	private long position=0;
	private double periodInSec = ((double)RobotConstants.ENCODER_TASK_PERIOD/1000);

	public Encoder(boolean inTPUA, int tpuChannel)
	{
		encoder = new TPU_FQD(inTPUA, tpuChannel);
		setPositionZero();
		period = RobotConstants.ENCODER_TASK_PERIOD;
		Task.install(this);
	}
	
	public void action(){
		position += encoder.getPosition();
		setPositionZero();
	}
	
	public long getPosition()
	{
		return position;
	}
	
	/*
	 * Speed in [Ticks/s]
	 */
	public double getSpeedInTicks()
	{
		return (double)position / periodInSec;
	}
	
	public void setZero()
	{
		position=0;
		encoder.setPosition(0);
	}
	
	public void setPositionZero()
	{
		encoder.setPosition(0);
	}
}